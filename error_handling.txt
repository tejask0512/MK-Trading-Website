1. Remove These Lines (around line 67-87):

# REMOVE these lines completely:
from config.database import db
db = SQLAlchemy()
db.init_app(app)



2. Replace Lines 50-90 with this structure:

# REPLACE the app creation section with:
app = Flask(__name__, template_folder="templates", static_folder="static")
app.secret_key = os.getenv("SECRET_KEY", "dev-secret-key-change-in-production")

# Database configuration
app.config['SQLALCHEMY_DATABASE_URI'] = get_database_url()
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False
app.config['SQLALCHEMY_ENGINE_OPTIONS'] = {
    'pool_pre_ping': True,
    'pool_recycle': 300,
    'pool_timeout': 20,
    'connect_args': {'connect_timeout': 10, 'options': '-c timezone=UTC'}
}

# Initialize database ONLY ONCE - ADD this line:
db = SQLAlchemy(app)



3. Remove This Line (around line 84):
# REMOVE this line completely:
db.init_app(app)



4. Fix Environment Variables - Replace in app.py:
# CHANGE this line:
ENV FLASK_ENV=production

# TO:
ENV FLASK_DEBUG=false



5. Update docker-compose.yml - Replace:

# REMOVE this line:
- FLASK_ENV=${FLASK_ENV:-production}
# ADD this line instead:
- FLASK_DEBUG=${FLASK_DEBUG:-false}


6. At the Bottom of app.py - Replace:

# CHANGE the last section from:
if __name__ == "__main__":
    app.run(debug=True, host="0.0.0.0", port=5000)
# TO:
# For gunicorn
application = app

if __name__ == "__main__":
    app.run(debug=DEVELOPMENT_MODE, host="0.0.0.0", port=5000)
